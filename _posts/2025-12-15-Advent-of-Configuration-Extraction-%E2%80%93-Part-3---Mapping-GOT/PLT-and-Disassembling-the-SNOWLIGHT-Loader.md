---
title: Advent of Configuration Extraction â€“ Part 3 - Mapping GOT/PLT and Disassembling the SNOWLIGHT Loader
date: 2025-12-15
categories: [MALWARE]
tags: [MALWARE,CONFIGURATION EXTRACTION,SNOWLIGHT,CYBERSECURITY]
---

In the latest installment of the "Advent of Configuration Extraction" series, the focus is on dissecting SNOWLIGHT, a lightweight ELF downloader that targets Linux systems. SNOWLIGHT is engineered to retrieve and execute remote payloads, communicating with its Command and Control (C2) server over a raw TCP socket. The downloader, developed in C and measuring under 10 kilobytes, initiates contact with the C2 server by sending a 6-byte message that includes an architecture pattern. This pattern indicates the processor family and architecture size, such as "l32" for Intel 32-bit or "a64" for ARM 64-bit. The server responds with a XOR-encoded payload, which SNOWLIGHT decodes using a hardcoded key before executing it in memory, leaving no trace on the disk. This technique is part of intrusion campaigns linked to the threat actor UNC5174, where SNOWLIGHT acts as an in-memory loader for the VShell remote access trojan.

The configuration extraction process for SNOWLIGHT involves a detailed static analysis of its binary, specifically targeting the x86_64 version. The primary goal is to extract the C2 server address, which is crucial for understanding the malware's communication strategy. The analysis reveals that the C2 address is stored in the .rodata section of the binary, immediately following the string "[kworker/0:2]". The TCP port used for communication is identified through assembly instructions, with the port number 8065 being explicitly set in the sockaddr_in structure. This information is crucial for security teams to identify and block malicious traffic associated with SNOWLIGHT.

To automate the extraction of SNOWLIGHT's configuration, two powerful tools are employed: LIEF and Capstone. LIEF is a cross-platform library that allows for parsing and modifying executable formats like ELF, providing access to low-level binary structures. It is instrumental in locating the .rodata section and extracting the C2 address. Capstone, on the other hand, is a disassembly engine that translates machine code into human-readable assembly instructions. It is used to resolve the mapping between the Global Offset Table (GOT) and the Procedure Linkage Table (PLT), which is essential for associating PLT entries with their corresponding imported function names, such as gethostbyname. This mapping is critical for identifying the instructions that set the TCP port and resolve the C2 address, enabling a comprehensive understanding of SNOWLIGHT's operational mechanics.

The technical insights gained from this analysis are invaluable for cybersecurity professionals aiming to defend against SNOWLIGHT and similar threats. By understanding the malware's configuration and communication methods, security teams can develop more effective detection and mitigation strategies. The use of tools like LIEF and Capstone highlights the importance of leveraging advanced technologies in malware analysis, providing a robust framework for dissecting complex threats and enhancing overall cybersecurity posture.

**To read the complete article see:** [Read more](https://blog.sekoia.io/advent-of-configuration-extraction-part-3-mapping-got-plt-and-disassembling-the-snowlight-loader/) 
